<!DOCTYPE html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<title>Flocking Behavior : Built with P5.js</title>
		<link rel="icon"  type="image/x-icon" />

		<!--[if lt IE 9]>
			<script type="text/javascript">alert("Your browser does not support the canvas tag.");</script>
		<![endif]-->
		<script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.0/p5.js"></script>
	</head>
	<body>
		<noscript>
			<p>JavaScript is required to view the contents of this page.</p>
		</noscript>
	</body>
</html>
<script language="javascript" type="text/javascript">
var things = [],
	wind,
	gravity;

function Mover (objWidth, objHeight, mass, xPos, yPos){
	this.xSize = objWidth;
	this.ySize = objHeight;
	this.mass = mass;
	this.loc = createVector(xPos, yPos);
	this.vel = createVector(0, 0);
	this.acc = createVector(0, 0);
	this.applyForce = function(force){
		var f = force.copy();
		f.div(this.mass);
		this.acc.add(f);
	}
	this.update = function(){
		this.vel.add(this.acc);
		this.loc.add(this.vel);

		this.acc.mult(0);
	}
	this.checkEdges = function(){
		
		//check left and right edge
		if (this.loc.x <= this.xSize) {
			this.loc.x = this.xSize;
			this.vel.x *= -0.9;
		} else if (this.loc.x >= (width - this.xSize)) {
			this.loc.x = (width - this.xSize);
			this.vel.x *= -0.9;
	    }
	    //check top and bottom edge
	    if (this.loc.y <= this.ySize) {
	    	this.loc.y = this.ySize;
	    	this.vel.y *= -0.9
	    } else if (this.loc.y >= (height - this.ySize)) {
	    	this.loc.y = (height - this.ySize);
	    	this.vel.y *= -0.9;
	    }
	}
	this.display = function(){
		stroke(0);
	    fill(175);
	    ellipse(this.loc.x, this.loc.y, this.xSize, this.ySize);
	}
}

function setup(){
	createCanvas(640,480);

	for(i=0; i<50; i++){
		var thingSize = random(30);
		var thingMass = random(5);
		var thingLocX = random(width);
		var thingLocY = random(height);
		things.push(new Mover(thingSize, thingSize, thingMass, thingLocX, thingLocY));
	}

	wind = createVector(0,0);
	gravity = createVector(0,0.3);

	frameRate(30);
}

function draw() {
	background(255);

	if(mouseIsPressed){
		console.log("mouse pressed");
		wind.set(0.5,0);
	} else wind.set(0,0);

	for(i=0; i<things.length; i++){
		things[i].applyForce(wind);
		var g = gravity.copy();
		things[i].applyForce(g.mult(things[i].mass));  //force of gravity depends on the mass of the object
		things[i].update();
		things[i].checkEdges();
		things[i].display();
	}
}

</script>